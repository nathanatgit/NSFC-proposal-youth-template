%% Style definitions

% define cref names
\crefname{figure}{图}{图}
\crefname{table}{表}{表}
\crefname{equation}{公式}{公式}
\crefname{algorithm}{算法}{算法}
% clear footers and headers
\pagestyle{empty}

% set font family
\setCJKmainfont[Mapping=tex-text,FallBack=SimSun-ExtB]{SimSun}
\setmainfont{Times New Roman}

% Create a new font family for both English and Chinese characters (KaiTi)
\newfontfamily\kaitienglish{KaiTi}
\newCJKfontfamily\kaitichinese{KaiTi}
\newcommand{\kaiti}{\kaitienglish\kaitichinese}

\newcommand{\tabfont}{\fontsize{10.5}{20}\selectfont}     % default table style 五号，固定行距20pt
\captionsetup{labelsep=space}   % remove the default colon between numbering and texts, remove this line and the caption will become 表1: 表标题 or 图1: 图表题
\captionsetup{font=singlespacing,labelsep=quad}% caption seperator: space. E.g 表1 表标题 or 图1 图表题
\captionsetup[subfloat]{labelformat=simple}
\renewcommand{\captionfont}{\heiti \wuhao}
% 图序及图题居中置于图的下方，表序及表题居中置于表的上方。
\captionsetup[table]{position=top,skip=0pt}
\captionsetup[figure]{position=bottom,skip=0pt,belowskip=-10.5pt}
% 图、表等与其前后的正文之间要有一行的间距
\textfloatsep = 20pt plus 0pt minus 10.5pt
\floatsep = 10.5pt plus 0pt minus 10.5pt
\intextsep= 20pt plus 0pt minus 10.5pt

% 常用字号
\newcommand{\chuhao}{\fontsize{42pt}{42pt}\selectfont}
\newcommand{\xiaochu}{\fontsize{36pt}{36pt}\selectfont}
\newcommand{\yihao}{\fontsize{26pt}{26pt}\selectfont}
\newcommand{\xiaoyi}{\fontsize{24pt}{24pt}\selectfont}
\newcommand{\erhao}{\fontsize{22pt}{22pt}\selectfont}
\newcommand{\xiaoer}{\fontsize{18pt}{18pt}\selectfont}
\newcommand{\sanhao}{\fontsize{16pt}{22pt}\selectfont}
\newcommand{\xiaosan}{\fontsize{15pt}{22pt}\selectfont}
\newcommand{\sihao}{\fontsize{14pt}{22pt}\selectfont}
\newcommand{\xiaosi}{\fontsize{12pt}{22pt}\selectfont}
\newcommand{\wuhao}{\fontsize{10.5pt}{22pt}\selectfont}
\newcommand{\xiaowu}{\fontsize{9pt}{9pt}\selectfont}
\newcommand{\liuhao}{\fontsize{7.5pt}{7.5pt}\selectfont}
\newcommand{\xiaoliu}{\fontsize{6.5pt}{6.5pt}\selectfont}
\newcommand{\qihao}{\fontsize{5.5pt}{5.5pt}\selectfont}
\newcommand{\bahao}{\fontsize{5pt}{5pt}\selectfont}

% Heading style definitions
\makeatletter
\@addtoreset{section}{part} % Reset section counter with each part
\makeatother

% （一）（二）（三）等
\titleformat{\part}[block]{\kaishu\sihao \color[rgb]{0,0.439,0.753}}{\textbf{（\chinese{part}）}}{0.5em}{} 
\titlespacing*{\part}{2em}{0pt}{2pt} % 缩进2字符，段前距0，段后距2pt
% 说明：Word模板定义，行距为固定行距22，稿纸设置中文本基线距离为15.6pt，正文字体为小四（12pt），蓝色标题的段后间距为0.5倍行距，大概为（22-15.6）/2 = 3pt，微调为2pt个人看起更接近于原Word模板。
% 不重要，WPS和Word打开文档格式都不一定一样，强迫症发疯设定😤。

% 1. 2. 3. 等
\titleformat{\section}[runin]{\kaiti\sihao \color[rgb]{0,0.439,0.753}}{\textbf{\heiti \thesection.}}{0.5em}{}
\titlespacing*{\section}{2em}{0pt}{2pt}

% 1.1 1.2 1.3 等
\titleformat{\subsection}[block]{\heiti\xiaosi }{\textbf{\thesubsection}}{0.5em}{}
\titlespacing*{\subsection}{2em}{0pt}{2pt}

% 1.1.1 1.1.2 1.1.3 等
\titleformat{\subsubsection}[block]{\heiti\xiaosi }{\textbf{\thesubsubsection}}{0.5em}{}
\titlespacing*{\subsubsection}{2em}{0pt}{0pt}

% 参考文献标题样式
\defbibheading{bibliography}[\refname]{%
\section*{{\vspace{3pt} \hspace{-2.5em} \color{black} \heiti #1}}
\markboth{#1}{#1} % Header marks
}

% Regular paragraph style
\setlength{\parindent}{2em} % 2 em indent

% For algorithms
\renewcommand{\algorithmicrequire}{\textbf{输入:}}
\renewcommand{\algorithmicensure}{\textbf{输出:}}
\algnewcommand{\algorithmicnoind}[1]{\textbf{#1}}
\algnewcommand{\Noind}[1]{\item[\algorithmicnoind{#1}]}
\algrenewcommand{\algorithmiccomment}[1]{\hspace{1em} // #1}
\makeatletter
\renewcommand{\ALG@name}{算法}
\makeatother